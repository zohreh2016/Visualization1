<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <style type="text/css">
        svg {
            font-family: "Helvetica Neue", Helvetica;
        }

        .line {
            fill: none;
            stroke: #000;
            stroke-width: 2px;
        }
    </style>
    <script src="//d3js.org/d3.v4.min.js"></script>
</head>
<body>
    <canvas width="960" height="500"></canvas>
    <script>

        var canvas = document.querySelector("canvas"),
            context = canvas.getContext("2d");

        var margin = { top: 20, right: 20, bottom: 30, left: 50 },
            width = canvas.width - margin.left - margin.right,
            height = canvas.height - margin.top - margin.bottom;

        var x = d3.scaleLinear().range([0, width]);

        var y = d3.scaleLinear().range([height, 0]);

        context.translate(margin.left, margin.top);

        d3.json("dg.json", function (error, us) {
            if (error) throw error;

            var data = us.counties;

            x.domain(d3.scaleLinear(data, function (d) { return d.year; }));
            y.domain(d3.scaleLinear(data, function (d) { return d.properties.rate; }));

            xAxis();
            yAxis();

            var line = d3.line()
                .x(function (d) { return x(d.year); })
                .y(function (d) { return y(d.properties.rate); })
                .curve(d3.curveStep)
                .context(context);

            context.beginPath();
            line(data);
            context.lineWidth = 1.5;
            context.strokeStyle = "steelblue";
            context.stroke();
        });

        function xAxis() {
            var tickCount = 10,
                tickSize = 6,
                ticks = x.ticks(tickCount),
                tickFormat = x.tickFormat();

            context.beginPath();
            ticks.forEach(function (d) {
                context.moveTo(x(d), height);
                context.lineTo(x(d), height + tickSize);
            });
            context.strokeStyle = "black";
            context.stroke();

            context.textAlign = "center";
            context.textBaseline = "top";
            ticks.forEach(function (d) {
                context.fillText(tickFormat(d), x(d), height + tickSize);
            });
        }

        function yAxis() {
            var tickCount = 10,
                tickSize = 6,
                tickPadding = 3,
                ticks = y.ticks(tickCount),
                tickFormat = y.tickFormat(tickCount);

            context.beginPath();
            ticks.forEach(function (d) {
                context.moveTo(0, y(d));
                context.lineTo(-6, y(d));
            });
            context.strokeStyle = "black";
            context.stroke();

            context.beginPath();
            context.moveTo(-tickSize, 0);
            context.lineTo(0.5, 0);
            context.lineTo(0.5, height);
            context.lineTo(-tickSize, height);
            context.strokeStyle = "black";
            context.stroke();

            context.textAlign = "right";
            context.textBaseline = "middle";
            ticks.forEach(function (d) {
                context.fillText(tickFormat(d), -tickSize - tickPadding, y(d));
            });

            context.save();
            context.rotate(-Math.PI / 2);
            context.textAlign = "right";
            context.textBaseline = "top";
            context.font = "bold 10px sans-serif";
            context.fillText("Percent", -10, 10);
            context.restore();
        }
    </script>
</body>
</html>
